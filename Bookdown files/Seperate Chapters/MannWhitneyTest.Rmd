## Mann-Whitney Test

An example from Hays (1974, pp. 778-780):

"As an example, consider the following data:"

```{r echo=F}
MWT.data <- data.frame(Score = c(8,3,4,6,1,7,9,10,12), Group = c(rep('A', 4), rep('B', 5)))
knitr::kable(head(MWT.data, 20), caption = "Data for Mann-Whitney Test", booktabs = T)
```

### Results Overview

```{r echo=F}
ResultsMWT <- matrix(c(rep(5,6)), ncol=6, byrow = T)
colnames(ResultsMWT) <- c('By Hand', 'JASP', 'SPSS', 'SAS', 'Minitab', 'R')
rownames(ResultsMWT) <- "U'"
knitr::kable(head(ResultsMWT, 20), caption = "Result Overview Mann-Whitney Test", booktabs = T)
```

### By Hand

Calculations by hand can be found in Hays, 1974, pp. 778-780.

Result: 

U' = 5

U  = 15

Not significant for $\alpha$ = .05 or less.


### JASP


```{r mwtJASP, echo=FALSE, fig.cap="\\label{fig:mwtJASP}JASP Output for Mann-Whitney Test"}
knitr::include_graphics('Screenshots/Mann WHitney/mwtJASP.PNG')
```
**Note:** W corresponds to U' in the hand calculation.


### SPSS

```{r eval=F}
DATASET ACTIVATE DataSet1.
*Nonparametric Tests: Independent Samples. 
NPTESTS 
  /INDEPENDENT TEST (Score) GROUP (Group) MANN_WHITNEY 
  /MISSING SCOPE=ANALYSIS USERMISSING=EXCLUDE
  /CRITERIA ALPHA=0.05  CILEVEL=95.

```


```{r mwtSPSS, echo=FALSE, fig.cap="\\label{fig:mwtSPSS}SPSS Output for Mann-Whitney Test"}
knitr::include_graphics('Screenshots/Mann WHitney/mwtSPSS.PNG')
```

**Note:** U = 15 corresponds to U' = 5.

### SAS

```{r eval=F}
PROC npar1way data=work.mwt wilcoxon;
class Group;
var Score;
run;
```


```{r mwtSAS, echo=FALSE, fig.cap="\\label{fig:mwtSAS}SAS Output for Mann-Whitney Test"}
knitr::include_graphics('Screenshots/Mann WHitney/mwtSAS.PNG')
```

**Note:** U = 15 corresponds to U' = 5.

### Minitab

```{r mwtMinitab, echo=FALSE, fig.cap="\\label{fig:mwtMinitab}Minitab Output for Mann-Whitney Test"}
knitr::include_graphics('Screenshots/Mann WHitney/mwtMinitab.PNG')
```

**Note:** W corresponds to U in the hand calculation and U = 15 corresponds to U' = 5.


### R
```{r echo=F}
MWT.data2 <- read.csv("Datasets/MannWhitney.csv", sep=";")
```


```{r}
wilcox.test(Score~Group, data = MWT.data2)
```
**Note:** W corresponds to U' in the hand calculation.


### Remarks

All differences in results between the software and hand calculation are due to rounding.

The output for the Mann-Whitney test is not clearly defined, leading to different conventions in different software. The R documentation explains it as follows:

"The two most common definitions correspond to the sum of the ranks of the first sample with the minimum value subtracted or not: R subtracts and S-PLUS does not, giving a value which is larger by m(m+1)/2 for a first sample of size m. (It seems Wilcoxon's original paper used the unadjusted sum of the ranks but subsequent tables subtracted the minimum.) R's value can also be computed as the number of all pairs (x[i], y[j]) for which y[j] is not greater than x[i], the most common definition of the Mann-Whitney test."
